<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedSim Vaka EditÃ¶rÃ¼ v2</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <style>
        :root {
    --primary: #2563eb;
    --primary-light: #eff6ff;
    --bg-body: #f3f4f6;
    --bg-card: #ffffff;
    --text-main: #1f2937;
    --text-muted: #6b7280;
    --border: #e5e7eb;
    --danger: #ef4444;
    --success: #10b981;
    --radius: 8px;
    --shadow: 0 1px 3px rgba(0,0,0,0.1);
}

* { box-sizing: border-box; }
body { margin: 0; font-family: 'Inter', sans-serif; background: var(--bg-body); color: var(--text-main); height: 100vh; overflow: hidden; }

/* Layout */
.app-container { display: flex; height: 100vh; }
.sidebar { width: 280px; background: var(--bg-card); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 1rem; z-index: 10; }
.main-content { flex: 1; display: flex; flex-direction: column; background: var(--bg-body); overflow: hidden; }

/* Sidebar */
.brand { display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1.5rem; color: var(--primary); }
.case-list-container { flex: 1; overflow-y: auto; margin: 1rem 0; }
.case-list { list-style: none; padding: 0; margin: 0; }
.case-list li { padding: 10px; border-radius: var(--radius); cursor: pointer; margin-bottom: 4px; font-size: 0.9rem; border: 1px solid transparent; }
.case-list li:hover { background: var(--primary-light); }
.case-list li.active { background: var(--primary-light); border-color: var(--primary); color: var(--primary); font-weight: 600; }

/* Header */
.top-bar { background: var(--bg-card); padding: 1rem 2rem; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
.case-meta { display: flex; align-items: center; gap: 1rem; width: 60%; }
.badge { background: var(--text-main); color: #fff; padding: 2px 8px; border-radius: 4px; font-size: 0.8rem; font-family: monospace; }
.seamless-input { border: none; font-size: 1.2rem; font-weight: 600; width: 100%; outline: none; background: transparent; }

/* Tabs */
.tabs-nav { display: flex; gap: 2px; padding: 0 2rem; background: var(--bg-card); border-bottom: 1px solid var(--border); overflow-x: auto; }
.tab-btn { background: none; border: none; padding: 1rem; cursor: pointer; color: var(--text-muted); font-weight: 500; border-bottom: 2px solid transparent; display: flex; align-items: center; gap: 6px; transition: all 0.2s; }
.tab-btn:hover { color: var(--primary); background: var(--primary-light); }
.tab-btn.active { color: var(--primary); border-bottom-color: var(--primary); }
.tab-pane { display: none; padding: 2rem; animation: fadeIn 0.3s; }
.tab-pane.active { display: block; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

.content-scroll-area { flex: 1; overflow-y: auto; padding-bottom: 4rem; }

/* Cards & Forms */
.card { background: var(--bg-card); border-radius: var(--radius); padding: 1.5rem; box-shadow: var(--shadow); border: 1px solid var(--border); margin-bottom: 1rem; }
.card h3 { margin-top: 0; font-size: 1rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid var(--border); padding-bottom: 0.5rem; margin-bottom: 1rem; }

.grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
.form-group { margin-bottom: 1rem; }
label { display: block; font-size: 0.85rem; font-weight: 500; margin-bottom: 0.4rem; color: var(--text-muted); }
input, select, textarea { width: 100%; padding: 0.6rem; border: 1px solid var(--border); border-radius: var(--radius); font-family: inherit; transition: border 0.2s; }
input:focus, textarea:focus { border-color: var(--primary); outline: none; ring: 2px solid var(--primary-light); }

/* Custom Elements */
.vital-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 0.5rem; }
.vital-item input { text-align: center; font-weight: bold; }

.styled-list .kv-row { display: flex; gap: 0.5rem; margin-bottom: 0.5rem; align-items: center; background: var(--bg-body); padding: 0.5rem; border-radius: var(--radius); }
.styled-list .kv-key { width: 30%; font-weight: 600; color: var(--primary); border: none; background: transparent; }
.styled-list .kv-value { flex: 1; border: none; background: transparent; }

.chip-grid { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.5rem; }
.chip { padding: 4px 10px; background: var(--primary-light); color: var(--primary); border: 1px solid transparent; border-radius: 20px; font-size: 0.8rem; cursor: pointer; transition: 0.2s; }
.chip:hover { background: var(--primary); color: #fff; }

.drug-row { background: #fff8f0; border: 1px solid #fed7aa; padding: 1rem; border-radius: var(--radius); margin-bottom: 0.5rem; position: relative; }

/* Buttons */
.btn { padding: 0.6rem 1rem; border-radius: var(--radius); border: none; font-weight: 500; cursor: pointer; display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; transition: 0.2s; }
.btn.primary { background: var(--primary); color: white; }
.btn.primary:hover { background: #1d4ed8; }
.btn.danger-ghost { color: var(--danger); background: transparent; }
.btn.danger-ghost:hover { background: #fee2e2; }
.btn.small { padding: 0.4rem 0.8rem; font-size: 0.85rem; }
.w-100 { width: 100%; }

/* Utilities */
.text-green { color: var(--success); }
.text-red { color: var(--danger); }
.mt-2 { margin-top: 1rem; }
.hidden { display: none; }
    </style>
</head>
<body>

<div class="app-container">
    <aside class="sidebar">
        <div class="brand">
            <span class="material-icons-round">medical_services</span>
            <h3>MedSim EditÃ¶r</h3>
        </div>
        
        <div class="sidebar-actions">
            <button id="addCaseBtn" class="btn primary-soft w-100">
                <span class="material-icons-round">add</span> Yeni Vaka
            </button>
            <button id="importJsonBtn" class="btn ghost w-100">
                <span class="material-icons-round">upload_file</span> JSON YÃ¼kle
            </button>
            <input type="file" id="jsonFileInput" hidden accept=".json">
        </div>

        <div class="case-list-container">
            <div class="search-box">
                <span class="material-icons-round">search</span>
                <input type="text" id="caseSearchInput" placeholder="Vaka ara...">
            </div>
            <ul id="caseList" class="case-list">
                </ul>
        </div>

        <div class="sidebar-footer">
            <button id="saveToLocalBtn" class="btn success small">
                <span class="material-icons-round">save</span> TarayÄ±cÄ±ya Kaydet
            </button>
            <button id="downloadJsonBtn" class="btn outline small">
                <span class="material-icons-round">download</span> Ä°ndir
            </button>
        </div>
    </aside>

    <main class="main-content">
        <header class="top-bar">
            <div class="case-meta">
                <span class="badge" id="caseIdDisplay">CASE-000</span>
                <input type="text" id="caseTitleInput" class="seamless-input" placeholder="Vaka BaÅŸlÄ±ÄŸÄ± Giriniz...">
            </div>
            <div class="top-actions">
                <div class="difficulty-selector">
                    <label>Zorluk:</label>
                    <select id="caseDifficultyInput">
                        <option value="kolay" class="text-green">ðŸŸ¢ Kolay</option>
                        <option value="orta" class="text-orange">ðŸŸ  Orta</option>
                        <option value="zor" class="text-red">ðŸ”´ Zor</option>
                    </select>
                </div>
                <button id="deleteCaseBtn" class="btn icon-only danger-ghost" title="VakayÄ± Sil">
                    <span class="material-icons-round">delete</span>
                </button>
            </div>
        </header>

        <nav class="tabs-nav">
            <button class="tab-btn active" data-tab="tab-patient">
                <span class="material-icons-round">person</span> Hasta & Hikaye
            </button>
            <button class="tab-btn" data-tab="tab-exam">
                <span class="material-icons-round">monitor_heart</span> Muayene & Vital
            </button>
            <button class="tab-btn" data-tab="tab-labs">
                <span class="material-icons-round">science</span> Laboratuvar
            </button>
            <button class="tab-btn" data-tab="tab-imaging">
                <span class="material-icons-round">image</span> GÃ¶rÃ¼ntÃ¼leme
            </button>
            <button class="tab-btn" data-tab="tab-treatment">
                <span class="material-icons-round">medication</span> Tedavi & Ä°laÃ§
            </button>
            <button class="tab-btn" data-tab="tab-final">
                <span class="material-icons-round">verified</span> SonuÃ§ & Puan
            </button>
        </nav>

        <div class="content-scroll-area">
            <form id="caseForm" autocomplete="off">
                
                <section id="tab-patient" class="tab-pane active">
                    <div class="grid-2">
                        <div class="card">
                            <h3>Hasta Profili</h3>
                            <div class="form-group">
                                <label>YaÅŸ</label>
                                <input type="number" id="patientAgeInput" class="input-lg">
                            </div>
                            <div class="form-group">
                                <label>Cinsiyet</label>
                                <div class="radio-group">
                                    <label class="radio-chip">
                                        <input type="radio" name="sex" value="E" id="sexM"> <span>Erkek</span>
                                    </label>
                                    <label class="radio-chip">
                                        <input type="radio" name="sex" value="K" id="sexF"> <span>KadÄ±n</span>
                                    </label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Triaj (Ã–ncelik)</label>
                                <select id="patientTriageInput">
                                    <option value="yeÅŸil">YeÅŸil (Acil DeÄŸil)</option>
                                    <option value="sarÄ±">SarÄ± (Acil)</option>
                                    <option value="kÄ±rmÄ±zÄ±">KÄ±rmÄ±zÄ± (Kritik)</option>
                                    <option value="siyah">Siyah (Eks)</option>
                                </select>
                            </div>
                        </div>
                        <div class="card">
                            <h3>Ortam & Etiketler</h3>
                            <div class="form-group">
                                <label>Ortam (Setting)</label>
                                <select id="patientSettingInput">
                                    <option value="ambulans">Ambulans</option>
                                    <option value="acil">Acil Servis (ER)</option>
                                    <option value="poliklinik">Poliklinik</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Etiketler (VirgÃ¼lle ayÄ±r)</label>
                                <input id="caseTagsInput" placeholder="Ã–r: kardiyoloji, travma">
                            </div>
                        </div>
                    </div>

                    <div class="card mt-2">
                        <h3>Klinik Senaryo</h3>
                        <div class="form-group">
                            <label>Paramedik Notu / Devir</label>
                            <textarea id="paramedicInput" rows="2" placeholder="112 ekibi ne diyor?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Hikaye (Anamnez)</label>
                            <textarea id="storyInput" rows="4" placeholder="HastanÄ±n ÅŸikayeti ve Ã¶ykÃ¼sÃ¼..."></textarea>
                        </div>
                    </div>
                </section>

                <section id="tab-exam" class="tab-pane">
                    <div class="card bg-gradient">
                        <h3>Vital Bulgular (Otomatik BirleÅŸtirici)</h3>
                        <div class="vital-grid">
                            <div class="vital-item">
                                <label>TA (mmHg)</label>
                                <input id="vitalBP" placeholder="120/80">
                            </div>
                            <div class="vital-item">
                                <label>NabÄ±z (/dk)</label>
                                <input id="vitalHR" type="number" placeholder="80">
                            </div>
                            <div class="vital-item">
                                <label>AteÅŸ (Â°C)</label>
                                <input id="vitalTemp" type="number" step="0.1" placeholder="36.5">
                            </div>
                            <div class="vital-item">
                                <label>SpO2 (%)</label>
                                <input id="vitalSat" type="number" placeholder="98">
                            </div>
                            <div class="vital-item">
                                <label>Solunum (/dk)</label>
                                <input id="vitalRR" type="number" placeholder="16">
                            </div>
                            <div class="vital-item">
                                <label>GKS</label>
                                <input id="vitalGCS" placeholder="15 (E4M6V5)">
                            </div>
                        </div>
                        <small class="hint">*DeÄŸerleri buraya girin, alttaki bÃ¼yÃ¼k kutuya otomatik yazÄ±lacaktÄ±r.</small>
                    </div>

                    <div class="card mt-2">
                        <h3>Fizik Muayene & DetaylÄ± Vitaller</h3>
                        <div class="form-group">
                            <label>Vital Bulgular (Tam Metin)</label>
                            <textarea id="examVitalsInput" rows="2" class="code-font"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Sistemik Muayene</label>
                            <textarea id="examPhysicalInput" rows="6" placeholder="BaÅŸ-Boyun: ..., Solunum: ..., BatÄ±n: ..."></textarea>
                            <div class="quick-tags">
                                <button type="button" class="chip" onclick="addToExam('Solunum sesleri doÄŸal.')">+ Solunum DoÄŸal</button>
                                <button type="button" class="chip" onclick="addToExam('BatÄ±n rahat, defans yok.')">+ BatÄ±n Rahat</button>
                                <button type="button" class="chip" onclick="addToExam('Ral/RonkÃ¼s yok.')">+ AkciÄŸer Temiz</button>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="tab-labs" class="tab-pane">
                    <div class="alert-box">
                        <span class="material-icons-round">info</span>
                        VarsayÄ±lan YanÄ±t: <input id="labsDefaultInput" value="Laboratuvar sonucu bekleniyor." class="inline-edit">
                    </div>
                    
                    <div class="split-view">
                        <div class="list-container">
                            <div class="list-header">
                                <h4>TanÄ±mlÄ± Tetkikler</h4>
                                <button type="button" id="addLabRowBtn" class="btn small primary">+ Ã–zel Ekle</button>
                            </div>
                            <div id="labsContainer" class="styled-list"></div>
                        </div>
                        
                        <div class="quick-pick-panel">
                            <h4>HÄ±zlÄ± Ekle</h4>
                            <div class="chip-grid" id="quickLabsArea">
                                </div>
                        </div>
                    </div>
                </section>

                <section id="tab-imaging" class="tab-pane">
                    <div class="card">
                         <div class="card-header-action">
                            <h3>GÃ¶rÃ¼ntÃ¼leme</h3>
                            <input id="imagingDefaultInput" placeholder="VarsayÄ±lan yanÄ±t..." class="input-sm">
                        </div>
                        <div class="split-view">
                             <div class="list-container full-width">
                                <div id="imagingContainer" class="styled-list"></div>
                                <button type="button" id="addImagingRowBtn" class="btn dashed mt-1">+ Manuel Ekle</button>
                             </div>
                             <div class="quick-pick-row" id="quickImagingArea">
                                 </div>
                        </div>
                    </div>

                     <div class="card mt-2">
                        <div class="card-header-action">
                           <h3>ProsedÃ¼r / MÃ¼dahale</h3>
                           <input id="proceduresDefaultInput" placeholder="VarsayÄ±lan yanÄ±t..." class="input-sm">
                       </div>
                       <div id="proceduresContainer" class="styled-list"></div>
                       <div class="quick-pick-row mt-1" id="quickProceduresArea"></div>
                   </div>
                </section>

                <section id="tab-treatment" class="tab-pane">
                    <div class="card">
                        <h3>Ä°laÃ§lar</h3>
                        <div id="drugsContainer" class="cards-grid"></div>
                        <div class="action-bar mt-2">
                            <button type="button" id="addDrugBtn" class="btn primary">
                                <span class="material-icons-round">add_circle</span> Ä°laÃ§ Ekle
                            </button>
                            <div class="dropdown-wrapper">
                                <button type="button" class="btn outline" id="toggleDrugPresets">SÄ±k KullanÄ±lanlar â–¼</button>
                                <div id="drugPresetsList" class="dropdown-content hidden"></div>
                            </div>
                        </div>
                    </div>

                    <div class="card mt-2">
                        <h3>KonsÃ¼ltasyonlar</h3>
                        <label>BÃ¶lÃ¼mler (VirgÃ¼lle ayÄ±r)</label>
                        <input id="consultsInput" placeholder="NÃ¶roloji, Genel Cerrahi">
                    </div>
                </section>

                 <section id="tab-final" class="tab-pane">
                    <div class="grid-2">
                        <div class="card">
                            <h3>TanÄ± ve SonuÃ§</h3>
                            <div class="form-group">
                                <label>Final TanÄ±</label>
                                <input id="finalDiagnosisInput" class="input-lg success-border">
                            </div>
                            <div class="form-group">
                                <label>Taburculuk/YatÄ±ÅŸ (Disposition)</label>
                                <input id="dispositionInput" placeholder="Taburcu, YBÃœ YatÄ±ÅŸ, Sevk...">
                            </div>
                        </div>
                        <div class="card">
                            <h3>Puanlama AyarlarÄ±</h3>
                            <div class="score-grid">
                                <div><label>BaÅŸlangÄ±Ã§ PuanÄ±</label><input type="number" id="baseScoreInput"></div>
                                <div><label>DoÄŸru TanÄ± Bonusu</label><input type="number" id="bonusDxInput" class="text-green"></div>
                                <div><label>Lab CezasÄ±</label><input type="number" id="penaltyLabInput" class="text-red"></div>
                                <div><label>GÃ¶rÃ¼ntÃ¼leme CezasÄ±</label><input type="number" id="penaltyImagingInput" class="text-red"></div>
                            </div>
                        </div>
                    </div>

                    <div class="card mt-2">
                        <h3>Medya DosyalarÄ±</h3>
                        <div class="form-group">
                            <label>Kapak GÃ¶rseli (URL/Path)</label>
                            <input id="mediaCoverInput">
                        </div>
                        <div class="form-group">
                            <label>EKG GÃ¶rseli</label>
                            <input id="mediaEkgInput">
                        </div>
                         <div class="form-group">
                            <label>Galeri (VirgÃ¼lle)</label>
                            <input id="mediaGalleryInput">
                        </div>
                    </div>
                </section>

            </form>
        </div>
    </main>
</div>

<script type="module" src="js/vaka-edit.js"></script>
</body>
</html>